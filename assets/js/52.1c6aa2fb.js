(window.webpackJsonp=window.webpackJsonp||[]).push([[52],{533:function(t,n,s){"use strict";s.r(n);var a=s(4),e=Object(a.a)({},(function(){var t=this,n=t.$createElement,s=t._self._c||n;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"线程的6个状态"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#线程的6个状态"}},[t._v("#")]),t._v(" 线程的6个状态")]),t._v(" "),s("p",[s("strong",[t._v("当线程创建和启动之后，线程一共经历6个状态。如下：")])]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("新建（new）")])]),t._v(" "),s("li",[s("strong",[t._v("可运行（Runnable）")])]),t._v(" "),s("li",[s("strong",[t._v("阻塞（blocked）")])]),t._v(" "),s("li",[s("strong",[t._v("等待（waiting）")])]),t._v(" "),s("li",[s("strong",[t._v("超时等待（Timed_Waiting）")])]),t._v(" "),s("li",[s("strong",[t._v("终止（Terminated）")])])]),t._v(" "),s("blockquote",[s("p",[t._v("如果想要确定线程当前的状态，可以通过 "),s("code",[t._v("getState()")]),t._v(" 方法，并且线程在任何时刻只可能处于 1 种状态。")])]),t._v(" "),s("h3",{attrs:{id:"_1-线程状态之间的转换"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-线程状态之间的转换"}},[t._v("#")]),t._v(" 1.线程状态之间的转换")]),t._v(" "),s("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://bee71-1302549720.cos.ap-shanghai.myqcloud.com/微信截图_20200718175211.png"}}),t._v(" "),s("p",[s("strong",[t._v("注意点：")])]),t._v(" "),s("ul",[s("li",[t._v("线程的状态是需要按照箭头方向来走的，比如线程从 New 状态是不可以直接进入 Blocked 状态的，它需要先经历 Runnable 状态。")]),t._v(" "),s("li",[t._v("从图中可以看出，线程的生命周期是不可逆的。只有中间的状态可以互相转换。")]),t._v(" "),s("li",[t._v("一般习惯而言，把"),s("code",[t._v("Blocked")]),t._v("、"),s("code",[t._v("Waiting")]),t._v("、"),s("code",[t._v("Timed_Waiting")]),t._v("都称为阻塞状态。")])]),t._v(" "),s("p",[t._v("特殊情况：")]),t._v(" "),s("ul",[s("li",[t._v("从"),s("code",[t._v("Object.wait()")]),t._v("方法刚被唤醒时，通常不能立刻抢到"),s("code",[t._v("Monitor")]),t._v("锁。那就会从"),s("code",[t._v("Waiting")]),t._v("状态先进入"),s("code",[t._v("Blocked")]),t._v("状态。抢到锁后再进入"),s("code",[t._v("Runnable")]),t._v("状态。")]),t._v(" "),s("li",[t._v("如果发生异常，可以直接跳到"),s("code",[t._v("Terminated")]),t._v("状态，不必遵循路径。比如可以从"),s("code",[t._v("Waiting")]),t._v("状态直接跳到"),s("code",[t._v("Terminated")]),t._v("状态。")])]),t._v(" "),s("h3",{attrs:{id:"_2-new、runnable和terminated状态"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-new、runnable和terminated状态"}},[t._v("#")]),t._v(" 2.New、Runnable和Terminated状态")]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("package")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("concurrency"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sixstates")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("NewRunnableTerminated")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("implements")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Runnable")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("run")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" args"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),t._v(" thread "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("NewRunnableTerminated")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//打印出new的状态")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("thread"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getState")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        \n        thread"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("start")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//打印出Runnable的状态")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("thread"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getState")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        \n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sleep")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("InterruptedException")]),t._v(" e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("printStackTrace")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//打印出Runnable状态，即使是正在运行，也是Runnable")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("thread"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getState")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sleep")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("InterruptedException")]),t._v(" e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("printStackTrace")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//打印出Terminated的状态")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("out"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("thread"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getState")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br"),s("span",{staticClass:"line-number"},[t._v("23")]),s("br"),s("span",{staticClass:"line-number"},[t._v("24")]),s("br"),s("span",{staticClass:"line-number"},[t._v("25")]),s("br"),s("span",{staticClass:"line-number"},[t._v("26")]),s("br"),s("span",{staticClass:"line-number"},[t._v("27")]),s("br"),s("span",{staticClass:"line-number"},[t._v("28")]),s("br"),s("span",{staticClass:"line-number"},[t._v("29")]),s("br"),s("span",{staticClass:"line-number"},[t._v("30")]),s("br"),s("span",{staticClass:"line-number"},[t._v("31")]),s("br"),s("span",{staticClass:"line-number"},[t._v("32")]),s("br"),s("span",{staticClass:"line-number"},[t._v("33")]),s("br"),s("span",{staticClass:"line-number"},[t._v("34")]),s("br"),s("span",{staticClass:"line-number"},[t._v("35")]),s("br"),s("span",{staticClass:"line-number"},[t._v("36")]),s("br")])]),s("p",[t._v("当程序使用new关键字创建一个线程时，该线程就处于新建状态。")]),t._v(" "),s("p",[t._v("这里的创建仅仅是在java语言层面被创建，在操作系统层面上，真正的线程还没有真正被创建，只有当我们调用了"),s("code",[t._v("start( )")]),t._v("方法之后，线程才会真正的被创建出来，进入Runnable状态。")]),t._v(" "),s("p",[t._v("当线程处于新建状态的时候，仅仅有java虚拟机为其分配内存，并初始化其成员变量的值。此时的线程不会表现出线程的任何动态特征，程序也不会执行线程的方法体。")]),t._v(" "),s("p",[t._v("与操作系统中的线程不一样，Java线程中将就绪（ready）和运行中（running）两种状态笼统的称为“可运行”。")]),t._v(" "),s("p",[t._v("当线程对象调用了start( )方法之后，线程就会处于就绪状态（Runnable）。java虚拟机就会为其创建方法调用栈和程序计数器。不过处于这个状态的线程并没有开始运行，只是表示该线程可以运行了。至于什么时候运行，取决于CPU什么时候调度它。")]),t._v(" "),s("p",[t._v("当处于就绪状态的线程获得了CPU调度后，开始执行run( )方法的执行体。该线程就处于运行中的状态。如果计算机只有一个CPU，那么在任何时刻都只有一个线程处于运行中状态。如果在多核CPU计算机上，那么在同一时刻会有数个线程并行执行。")]),t._v(" "),s("p",[t._v("一个线程运行后不可能一直处在运行中状态。线程在运行过程中需要被中断，目的是使其他线程获得运行的机会。")]),t._v(" "),s("p",[t._v("现在的系统和服务器都采用抢占式调度策略。系统会给每个可执行的线程一个小时间片来处理任务，当时间片用完后，系统就会剥夺该线程所占用的资源，让其他线程获得执行的机会。在选择下一个线程时，系统会考虑线程的优先级。")]),t._v(" "),s("h3",{attrs:{id:"_3-blocked、waiting和timed-waiting状态"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-blocked、waiting和timed-waiting状态"}},[t._v("#")]),t._v(" 3.Blocked、Waiting和Timed_Waiting状态")]),t._v(" "),s("p",[s("strong",[t._v("从图中可以看出，线程进入Waiting状态有三种可能性：")])]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("没有设置timeout参数的object.wait( )方法。")])]),t._v(" "),s("li",[s("strong",[t._v("没有设置Timeout参数的Thread.join() 方法。")])]),t._v(" "),s("li",[s("strong",[t._v("LockSupport.park() 方法。")])])]),t._v(" "),s("p",[t._v("**\n"),s("strong",[t._v("刚才说过，Blocked只针对synchronized的monitor锁 ，"),s("strong",[s("strong",[t._v("但是在java中还有很多其他的锁")])]),t._v("。")]),t._v(" "),s("strong",[t._v("比如 ReentrantLock，如果线程在获取这种锁时没有抢到该锁就会进入Waiting状态，因为本质上它执行了LockSupport.park()方法，所以会进入Waiting状态。")]),t._v(" "),s("strong",[t._v("同样，Object.wait()和Thread.join()也会让线程进入Waiting状态。同样，Object.wait() 和 Thread.join() 也会让线程进入 Waiting 状态。")]),t._v("\n**\n"),s("strong",[t._v("Blocked状态和Waiting状态的区别在于Blocked是在等待其他线程释放monitor锁，而****Waiting 则是在等待某个条件，比如join的线程执行完毕，或者是 notify( )/notifyAll( ) 。")])]),t._v(" "),s("hr"),t._v(" "),s("p",[s("strong",[t._v("因为waiting状态是不限时的，所以无论过多长时间，它都不会主动恢复。所以从waiting状态到其他状态情况有点特殊。")]),t._v(" "),s("strong",[t._v("从图中可以看出：")]),t._v(" "),s("strong",[t._v("只有当"),s("strong",[s("strong",[t._v("执行了 LockSupport.unpark()方法")])]),t._v("，或者 "),s("strong",[s("strong",[t._v("join 的线程运行结束")])]),t._v("，或者"),s("strong",[s("strong",[t._v("被中断时")])]),t._v("才可以进入 Runnable 状态。")])]),t._v(" "),s("p",[s("strong",[t._v("如果其他线程调用notify()或notifyAll()来唤醒它，它会直接进入Blocked状态。"),s("strong",[s("strong",[t._v("因为唤醒 Waiting 线程的线程如果调用 notify() 或 notifyAll()，要求必须首先持有该monitor锁")])]),t._v("，所以处于 Waiting状态的线程被唤醒时拿不到该锁，就会进入 Blocked 状态，直到执行了notify()/notifyAll() 的唤醒它的线程执行完毕并释放 monitor锁，才可能轮到它去抢夺这把锁，如果它能抢到，就会从 Blocked 状态回到Runnable 状态。")])]),t._v(" "),s("h3",{attrs:{id:""}},[s("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")])]),t._v(" "),s("p",[s("strong",[t._v("Timed Waiting状态和Waiting状态很相似，区别仅仅在于有没有时间****限制。Timed Waiting状态会等待超时，由系统自动唤醒，或者在超时前被唤醒信号唤醒")]),t._v("。")]),t._v(" "),s("p",[s("strong",[t._v("以下情况会让线程进入Timed Waiting状态：")])]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("设置了时间参数的object.wait(long timeout)方法。")])]),t._v(" "),s("li",[s("strong",[t._v("设置了时间参数的Thread.sleep(long millis)方法。")])]),t._v(" "),s("li",[s("strong",[t._v("设置了时间参数的Thread.join(long millis)方法。")])]),t._v(" "),s("li",[s("strong",[t._v("设置了时间参数的LockSupport.parkNanos(long nanos) 方法和 LockSupport.parkUntil(long deadline) 方法。")])])]),t._v(" "),s("p",[s("strong",[t._v("对于处于Timed Waiting状态的线程而言，以下几种情况可以直接进入Runnable状态，无需经过Blocked状态：")])]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("超时时间到了且能直接获取到monitor锁。")])]),t._v(" "),s("li",[s("strong",[t._v("join的线程运行结束。")])]),t._v(" "),s("li",[s("strong",[t._v("被中断。")])]),t._v(" "),s("li",[s("strong",[t._v("调用了LockSupport.unpark()。")])])]),t._v(" "),s("p",[t._v("**\n"),s("strong",[t._v("同样在Timed Waiting 中执行 notify() 和notifyAll() 也是一样的道理，它们会先进入 Blocked 状态，然后抢夺锁成功后，再回到Runnable 状态。")])]),t._v(" "),s("h3",{attrs:{id:"terminated状态"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#terminated状态"}},[t._v("#")]),t._v(" "),s("strong",[t._v("Terminated状态")])]),t._v(" "),s("p",[s("strong",[t._v("1、因为run方法正常退出而自然死亡。")]),t._v(" "),s("strong",[t._v("2、出现一个没有捕获的异常，终止了run( )方法。最终导致意外终止。")])]),t._v(" "),s("h3",{attrs:{id:"_4-线程状态的常见面试题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-线程状态的常见面试题"}},[t._v("#")]),t._v(" 4.线程状态的常见面试题")]),t._v(" "),s("ol",[s("li",[t._v("线程有哪几种状态？生命周期是什么？")]),t._v(" "),s("li")]),t._v(" "),s("hr")])}),[],!1,null,null,null);n.default=e.exports}}]);