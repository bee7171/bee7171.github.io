(window.webpackJsonp=window.webpackJsonp||[]).push([[57],{538:function(s,a,t){"use strict";t.r(a);var n=t(4),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"_1-java内存模型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-java内存模型"}},[s._v("#")]),s._v(" 1.Java内存模型")]),s._v(" "),t("h3",{attrs:{id:"_1-1-什么是jmm？"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-什么是jmm？"}},[s._v("#")]),s._v(" 1-1.什么是JMM？")]),s._v(" "),t("blockquote",[t("p",[s._v("全称：Java Memory Model。是一种规范")])]),s._v(" "),t("h3",{attrs:{id:"_1-2-为什么需要jmm？"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-为什么需要jmm？"}},[s._v("#")]),s._v(" 1-2.为什么需要JMM？")]),s._v(" "),t("h2",{attrs:{id:"_2-重排序"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-重排序"}},[s._v("#")]),s._v(" 2.重排序")]),s._v(" "),t("h3",{attrs:{id:"_2-1-什么是重排序？"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-什么是重排序？"}},[s._v("#")]),s._v(" 2-1.什么是重排序？")]),s._v(" "),t("p",[s._v("在某个线程内的几行代码的实际执行顺序跟Java文件中的顺序不一致，代码指令并不是严格按照代码语句顺序来执行的，它们的顺序被改变了，这就是重排序。")]),s._v(" "),t("h3",{attrs:{id:"_2-2-重排序的好处"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-重排序的好处"}},[s._v("#")]),s._v(" 2-2.重排序的好处")]),s._v(" "),t("ul",[t("li",[s._v("提高处理速度。重排序后会对指令进行优化。")])]),s._v(" "),t("h3",{attrs:{id:"_2-3-重排序的3种情况"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-重排序的3种情况"}},[s._v("#")]),s._v(" 2-3.重排序的3种情况")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("编译器优化")]),s._v("：包括JVM，JIT编译器等。")]),s._v(" "),t("li",[t("strong",[s._v("CPU指令重排")]),s._v("：就算编译器没重排，CPU也有可能进行重排序。")]),s._v(" "),t("li",[t("strong",[s._v("内存的“重排序”")]),s._v("：线程A的修改数据，线程B却看不到，引出可见性的问题。")])]),s._v(" "),t("h2",{attrs:{id:"_3-可见性"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-可见性"}},[s._v("#")]),s._v(" 3.可见性")]),s._v(" "),t("h3",{attrs:{id:"_3-1-什么是可见性问题？"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-什么是可见性问题？"}},[s._v("#")]),s._v(" 3-1.什么是可见性问题？")]),s._v(" "),t("h3",{attrs:{id:"_3-2-为什么会有可见性问题？"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-为什么会有可见性问题？"}},[s._v("#")]),s._v(" 3-2.为什么会有可见性问题？")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://bee71-1302549720.cos.ap-shanghai.myqcloud.com/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20200803094058.png",alt:""}})]),s._v(" "),t("ul",[t("li",[s._v("cpu有多级缓存，导致读的数据过期了。\n"),t("ul",[t("li",[s._v("高速缓存的容量比主内存小，但是速度仅次于寄存器。所以在CPU与主内存之间加了多级cache层。")]),s._v(" "),t("li",[s._v("线程间对于共享变量的可见性问题不是直接由多核引起的，而是由多缓存引起的。")]),s._v(" "),t("li",[s._v("如果所有核心都只用一个缓存，那么就不存在可见性问题了。")]),s._v(" "),t("li",[s._v("事实上，每个核心都会将自己需要的数据读到自己的独占缓存中，数据修改也是写入到缓存中，然后等刷入到主内存中。所以会导致有些核心读取到的值是一个过期的值。")])])])]),s._v(" "),t("h3",{attrs:{id:"_3-3-jmm的抽象：主内存与本地内存"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-jmm的抽象：主内存与本地内存"}},[s._v("#")]),s._v(" 3-3.JMM的抽象：主内存与本地内存")]),s._v(" "),t("ul",[t("li",[s._v("Java作为一门高级语言，屏蔽了这些底层细节，用JMM定义了一套读写内存数据的规范。")]),s._v(" "),t("li",[s._v("虽然我们不再需要关注一级缓存，二级缓存的问题，但JMM基于此抽象出了主内存和本地内存的概念。")]),s._v(" "),t("li",[s._v("这里说的本地内存并不是真的一块给每个线程分配的内存。而是JMM的一个抽象。是对于寄存器，一级缓存，二级缓存等的一个抽象。")])]),s._v(" "),t("img",{staticStyle:{zoom:"67%"},attrs:{src:"https://bee71-1302549720.cos.ap-shanghai.myqcloud.com/微信截图_20200803095342.png"}}),s._v(" "),t("h3",{attrs:{id:"_3-4-主内存与本地内存的关系"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-主内存与本地内存的关系"}},[s._v("#")]),s._v(" 3-4.主内存与本地内存的关系")]),s._v(" "),t("ul",[t("li",[s._v("JMM有以下规定：\n"),t("ol",[t("li",[s._v("所有的变量都存储在主内存中。同时每个线程也有自己独立的工作内存。工作内存中的变量是主内存中的拷贝。")]),s._v(" "),t("li",[s._v("线程不能直接读写主内存中的变量。而是只能操作自己工作内存中的变量，然后再同步到主内存中。")]),s._v(" "),t("li",[s._v("主内存是多个线程共享的，但是线程间不共享工作内存。如果线程间需要通信，需要借助主内存来中转完成。")])])])]),s._v(" "),t("h2",{attrs:{id:"_4-happens-before原则"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-happens-before原则"}},[s._v("#")]),s._v(" 4.happens-before原则")]),s._v(" "),t("h3",{attrs:{id:"_4-1-什么是happens-before？"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-什么是happens-before？"}},[s._v("#")]),s._v(" 4-1.什么是happens-before？")]),s._v(" "),t("div",{staticClass:"language-markdown line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-markdown"}},[t("code",[s._v("两种解释，不过都是一种意思！\n\n"),t("span",{pre:!0,attrs:{class:"token list punctuation"}},[s._v("1.")]),s._v(" happens-before规则是用来解决可见性问题的。在时间上，动作A发生在动作B之前，B保证能看见A。\n\n"),t("span",{pre:!0,attrs:{class:"token list punctuation"}},[s._v("2.")]),s._v(" 两个操作可以用happens—before规则来确定他们的执行顺序。如果一个操作happens-before于另一个操作。那么我们就说第一个操作对于第二个操作是可见的。\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h3",{attrs:{id:"_4-2-什么不是happens-before？"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-什么不是happens-before？"}},[s._v("#")]),s._v(" 4-2.什么不是happens-before？")]),s._v(" "),t("div",{staticClass:"language-markdown line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-markdown"}},[t("code",[s._v("两个线程没有互相配合的机制，所以代码X和Y的执行结果并不能保证总被对方看到，这就不具备happens-before规则。\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"_4-3-happens-before规则有哪些？"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-happens-before规则有哪些？"}},[s._v("#")]),s._v(" 4-3.happens-before规则有哪些？")]),s._v(" "),t("div",{staticClass:"language-markdown line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-markdown"}},[t("code",[s._v("先整体过一遍：\n\t1.单线程规则\n\t2.锁操作（synchronized和lock)\n\t3.volatile关键字\n\t4.线程启动\n\t5.线程join\n\t6.传递性\n\t7.中断\n\t8.构造方法\n\t9.工具类中的happens-before原则\n\t\t1.线程安全的容器在get之前一定能看到之前put的数据。\n\t\t2.CountDownLatch\n\t\t3.Semaphore\n\t\t4.Future\n\t\t5.线程池\n\t\t6.CyclicBarrier\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br")])]),t("ol",[t("li",[t("p",[t("strong",[s._v("单线程规则")]),s._v("\n后运行的语句一定能看到先运行的语句。")])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("锁操作（synchronized和lock)")])])])]),s._v(" "),t("img",{staticStyle:{zoom:"67%"},attrs:{src:"https://bee71-1302549720.cos.ap-shanghai.myqcloud.com/微信截图_20200803103350.png"}}),s._v(" "),t("p",[s._v("从图中可以看出，线程A解锁后，线程B拿到了锁，那么线程A解锁之前所有的操作对线程B都是可见的。反过来也是如此。")]),s._v(" "),t("ol",{attrs:{start:"3"}},[t("li",[t("strong",[s._v("volatile关键字")])])]),s._v(" "),t("p",[s._v("只要你写线程修改了数据，那么我读线程一定能读取到你修改后的数据。")]),s._v(" "),t("ol",{attrs:{start:"4"}},[t("li",[t("strong",[s._v("线程启动")])])]),s._v(" "),t("p",[s._v("线程启动前的操作对线程里的"),t("code",[s._v("run")]),s._v("方法都是可见的。")]),s._v(" "),t("ol",{attrs:{start:"5"}},[t("li",[t("strong",[s._v("线程join")])])]),s._v(" "),t("p",[s._v("join后面的语句一定能看到执行join方法的线程里面的语句。")]),s._v(" "),t("ol",{attrs:{start:"6"}},[t("li",[t("strong",[s._v("传递性")])])]),s._v(" "),t("p",[s._v("很简单，A和B符合规则，B和C符合规则，那么A和C也符合规则。")]),s._v(" "),t("ol",{attrs:{start:"7"}},[t("li",[t("strong",[s._v("中断")])])]),s._v(" "),t("p",[s._v("一个线程被其他线程interrupt了，那么检测中断（"),t("code",[s._v("isInterrupted")]),s._v("）或者抛出"),t("code",[s._v("InterruptedException")]),s._v("一定能看到。")]),s._v(" "),t("ol",{attrs:{start:"8"}},[t("li",[t("strong",[s._v("构造方法")])])]),s._v(" "),t("p",[s._v("对象构造方法的最后一行指令happens-before于finalize的第一行指令。")]),s._v(" "),t("ol",{attrs:{start:"9"}},[t("li",[t("strong",[s._v("工具类的happens-before原则")]),s._v(" "),t("ol",[t("li",[s._v("比如"),t("code",[s._v("ConcurrentHashMap")])]),s._v(" "),t("li",[s._v("。。。。。后面再详细学习。")])])])]),s._v(" "),t("h2",{attrs:{id:"_5-volatile关键字"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-volatile关键字"}},[s._v("#")]),s._v(" 5.volatile关键字")]),s._v(" "),t("h3",{attrs:{id:"_5-1-volatile是什么？"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-volatile是什么？"}},[s._v("#")]),s._v(" 5-1.volatile是什么？")]),s._v(" "),t("div",{staticClass:"language-markdown line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-markdown"}},[t("code",[t("span",{pre:!0,attrs:{class:"token list punctuation"}},[s._v("1.")]),s._v(" volatile是一种同步机制，比synchronized或lock相关类更加轻量。因为使用volatile不会发生上下文切换等开销大的行为。\n\n"),t("span",{pre:!0,attrs:{class:"token list punctuation"}},[s._v("2.")]),s._v(" 如果一个变量被修饰volatile，那么JVM就知道了这个变量可能会被并发修改。\n\n"),t("span",{pre:!0,attrs:{class:"token list punctuation"}},[s._v("3.")]),s._v(" 开销小，但是发挥的功能也小，volatile做不到synchronized那样的原子保护，只能在有限的场景下发挥作用。\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h3",{attrs:{id:"_5-2-volatile的适用场合"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-volatile的适用场合"}},[s._v("#")]),s._v(" 5-2.volatile的适用场合")]),s._v(" "),t("div",{staticClass:"language-markdown line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-markdown"}},[t("code",[s._v("不适用的场合  ：  a++\n\n适用场合1：boolean flag。 如果一个共享变量只能被各个线程赋值，没有其他的操作。就像布尔值一样。要么true，要么false。那么它自身就有原子性，再加上volatile          保证可见性就足以保证线程安全。\n\n适用场合2：作为刷新之前变量的触发器。\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h3",{attrs:{id:"_5-3-volatile的两点作用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-volatile的两点作用"}},[s._v("#")]),s._v(" 5-3.volatile的两点作用")]),s._v(" "),t("div",{staticClass:"language-markdown line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-markdown"}},[t("code",[s._v("1.可见性：\n\t读一个volatile变量之前，需要先使相应的本地缓存失效，直接到主内存中读取最新值。写一个volatile变量值会立即刷入到主内存中。\n\n2.禁止指令重排序优化：\n\t解决单例双重锁乱入问题。\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h3",{attrs:{id:"_5-4-volatile和synchronized的关系"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-4-volatile和synchronized的关系"}},[s._v("#")]),s._v(" 5-4.volatile和synchronized的关系")]),s._v(" "),t("div",{staticClass:"language-markdown line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-markdown"}},[t("code",[s._v("1.volatile是轻量版的synchronized：\n\t如果一个共享变量只能被各个线程赋值，没有其他的操作，就可以用volatile代替synchronized或原子变量。因为赋值自身是有原子性的，而volatile可以保证可见性。\t就保证了线程安全。\n\t\n2.\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h3",{attrs:{id:"_5-5-volatile小结"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-5-volatile小结"}},[s._v("#")]),s._v(" 5-5.volatile小结")]),s._v(" "),t("h2",{attrs:{id:"_6-jmm应用实例：单例模式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-jmm应用实例：单例模式"}},[s._v("#")]),s._v(" 6.JMM应用实例：单例模式")]),s._v(" "),t("h3",{attrs:{id:"_6-2-单例模式的8种写法"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-单例模式的8种写法"}},[s._v("#")]),s._v(" 6-2.单例模式的8种写法")]),s._v(" "),t("h4",{attrs:{id:"饿汉式单例（静态常量）-可用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#饿汉式单例（静态常量）-可用"}},[s._v("#")]),s._v(" 饿汉式单例（静态常量）(可用)")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Singleton1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//定义一个私有的静态实例instance。")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Singleton1")]),s._v(" instance "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Singleton1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//定义私有的构造方法")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Singleton1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//定义一个方法，只能通过这个方法获取到这个类的实例")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Singleton1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getInstance")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" instance"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("h4",{attrs:{id:"饿汉式单例（静态代码块）-可用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#饿汉式单例（静态代码块）-可用"}},[s._v("#")]),s._v(" 饿汉式单例（静态代码块）(可用)")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Singleton1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//先定义一个私有的对象引用量instance。")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Singleton2")]),s._v(" instance"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//在静态代码块中生成实例")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        instance "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Singleton2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//定义私有的构造方法")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Singleton2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//定义一个方法，只能通过这个方法获取到这个类的实例")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Singleton2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getInstance")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" instance"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("h4",{attrs:{id:"懒汉式单例（线程不安全）（不可用）"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#懒汉式单例（线程不安全）（不可用）"}},[s._v("#")]),s._v(" 懒汉式单例（线程不安全）（不可用）")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Singleton3")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//先定义一个私有静态变量，不生成实例")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Singleton3")]),s._v(" instance"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("    \n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//定义私有的构造方法")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Singleton3")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("   \n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//只能通过该方法获取唯一的instance实例")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Singleton3")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getInstance")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("       \n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//懒汉式单例在用户第一次调用时再进行初始化")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("instance "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            instance "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Singleton3")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" instance"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("h4",{attrs:{id:"懒汉式单例（线程安全，同步方法）（不推荐用）"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#懒汉式单例（线程安全，同步方法）（不推荐用）"}},[s._v("#")]),s._v(" 懒汉式单例（线程安全，同步方法）（不推荐用）")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Singleton4")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//先定义一个私有静态变量，不生成实例")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Singleton4")]),s._v(" instance"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("    \n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//定义私有的构造方法")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Singleton4")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("   \n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//只能通过该方法获取唯一的instance实例")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("synchronized")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Singleton4")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getInstance")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("       \n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//懒汉式单例在用户第一次调用时再进行初始化")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("instance "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            instance "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Singleton4")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" instance"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("h4",{attrs:{id:"懒汉式单例（线程不安全，同步代码块）（不可用）"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#懒汉式单例（线程不安全，同步代码块）（不可用）"}},[s._v("#")]),s._v(" 懒汉式单例（线程不安全，同步代码块）（不可用）")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Singleton5")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//先定义一个私有静态变量，不生成实例")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Singleton5")]),s._v(" instance"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("    \n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//定义私有的构造方法")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Singleton5")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("   \n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//只能通过该方法获取唯一的instance实例")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Singleton5")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getInstance")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("       \n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//懒汉式单例在用户第一次调用时再进行初始化")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("instance "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n           "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("synchronized")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Singleton5")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n               instance "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Singleton5")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n           "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" \n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" instance"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br")])]),t("h4",{attrs:{id:"双重校验锁（推荐用）"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#双重校验锁（推荐用）"}},[s._v("#")]),s._v(" 双重校验锁（推荐用）")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Singleton")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    \n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//定义一个私有的静态变量，注意这里的volatile关键字，这是必须的")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("volatile")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Singleton")]),s._v(" instance"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    \n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//定义私有的构造方法")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Singleton")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    \n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Singleton")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getInstance")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//第一个校验是是为了提高代码效率")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("instance "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("synchronized")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Singleton")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("instance "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                    instance "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Singleton")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" instance"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);